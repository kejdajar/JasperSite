@using JasperSiteCore.Models
@using JasperSiteCore.Areas.Admin.Models
@model JasperSiteCore.Areas.Admin.ViewModels.ThemesViewModel
@{
    ViewBag.Title = "Vzhledy";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
@section Scripts {
    <script src="~/Areas/Admin/Content/Scripts/SavedInfoPanel.js"></script>

}
<div id="vzhledy"></div>

<div class="jumbotron"><h1><i class="fa fa-diamond j-icon" aria-hidden="true"></i> Vzhledy</h1></div>



<h2> <i class="fa fa-info-circle j-icon" aria-hidden="true"></i> Nainstalované vzhledy </h2>

<!--NOT REGISTERED THEMES IN FOLDER-->
@if (Model.NotRegisteredThemeNames.Count > 0)
{
    <section class="j-admin-section">
        <div class="alert alert-warning fade show" role="alert">
           
            <strong>Složka se vzhledy byla upravena - neregistrované vzhledy</strong> <br />
            Ve složce: <i> @Configuration.GlobalWebsiteConfig.ThemeFolder</i>, ve které jsou uloženy vzhledy, došlo ke změnám, které je nutné
            uložit. Neregistrované vzhledy:
            @foreach (string name in Model.NotRegisteredThemeNames)
            {
                @name @:,
            }

            <a class="btn btn-jasper" asp-controller="Home" asp-action="AddNewAddedThemesToDb" asp-area="Admin">Registrovat nové vzhledy do databáze.</a>
           
        </div>
    </section>
}

<!--MANUALLY DELETED THEMES STILL REGISTERED IN DATABASE-->
@if (Model.ManuallyDeletedThemeNames.Count > 0)
{
    <section class="j-admin-section">
        <div class="alert alert-warning fade show" role="alert">
           
            <strong>Složka se vzhledy byla upravena - manuálně smazány vzhledy</strong> <br />
            Ve složce: <i> @Configuration.GlobalWebsiteConfig.ThemeFolder</i>, ve které jsou uloženy vzhledy, došlo ke změnám, které je nutné
            uložit. Manuálně odstraněné vzhledy:
            @foreach (string name in Model.ManuallyDeletedThemeNames)
            {
                @name @:,
            }

            <a class="btn btn-jasper" asp-controller="Home" asp-action="RemoveManuallyDeletedThemesFromDb" asp-area="Admin">Odstranit nedostupné vzhledy z datbáze.</a>
        </div>
    </section>
}



@if (Model.ManuallyDeletedThemeNames.Count == 0 && Model.NotRegisteredThemeNames.Count == 0)
{
    <section class="j-admin-section">
        <div id="mainForm1">
            @Html.Partial("ThemesPartialView", Model)
        </div>
    </section>
}
else
{
    <section class="j-admin-section">
        <div class="alert alert-info alert-dismissible fade show" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            <strong>Seznam vzhledů</strong> <br />
            Oblast pro operace se vzhledy není momentálně dostupná. Vyřešte prosím nejprve výše uvedené problémy.
        </div>
    </section>

}


<section class="j-admin-section">
    <div class="alert alert-info alert-dismissible fade show" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        <strong>Informace o nastavení systému</strong> <br />
        Složka se vzhledy:<b> @Model.ThemeFolder</b>, právě aktivní vzhled:<b> @Model.SelectedThemeName </b>
    </div>

    <div class="alert alert-info alert-dismissible fade show" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        <strong>Inteligetní změna vzhledu</strong> <br />
        Redakční systém obsahuje algoritmus pro inteligentní změnu vzhledu. Pokud nově aktivovaný
        vzhled obsahuje stejně pojmenované kontejnery, tak se textové bloky automaticky přiřadí k novým kontejnerům.
    </div>
</section>

<section class="j-admin-section">
    <h2> <i class="fa fa-info-circle j-icon" aria-hidden="true"></i> Vlastní rozšíření </h2>
    <p>JasperSiteCore je možné rozšiřovat o vlastní vzhledy. Návod pro tvorbu vlastního vzhledu nalezente v dokumentaci.</p>

    <form enctype="multipart/form-data" asp-controller="Home" asp-action="UploadTheme" asp-area="Admin">
        <div class="form-group">
            <label for="files">Nahrání vzhledu</label>
            <input type="file" class="form-control-file" id="files" name="files" aria-describedby="fileHelp" multiple>
            <small id="fileHelp" class="form-text text-muted"> Vzhled je potřeba nahrát v se formátu .zip</small>
            <input type="submit" value="Odeslat data" />
        </div>
    </form>
    <hr />
</section>

<section class="j-admin-section">
    <div>
        <p>Pokud jste manuálně modifikovali vzhledy na serveru, je potřeba tyto změny potvrdit pomocí následující volby:</p>
        <a class="btn btn-jasper" asp-controller="Home" asp-action="UpdateConfiguration" asp-area="Admin">Aplikovat data z konfiguračních souborů</a>
    </div>

    <div>
        <a class="btn btn-jasper" asp-controller="Home" asp-action="ReconstructAllThemesCorrespondingDatabaseTables" asp-area="Admin">Rekonstrukce databáze</a>
    </div>
</section>





<!-- Delete Theme Modal -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" style="margin-left:20px">Skutečně odstranit vzhled?</h4>
            </div>
            <div class="modal-body">
                Chystáte se odstranit vzhled <span id="themeNameModal"></span>

            </div>
            <div class="modal-footer">
                <a id="deleteModalButton" title="Odstranit" class="btn btn-jasper btn-jasper-delete"> <i class="fa fa-trash fa-1x" aria-hidden="true"></i> Trvale odstranit  </a>
                <button type="button" class="btn btn-jasper" data-dismiss="modal" title="Zrušit">Zrušit</button>
            </div>
        </div>

    </div>
</div>


@*<!-- Error Modal -->
    <div id="myErrorModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" style="margin-left:20px">Chyba</h4>
                </div>
                <div class="modal-body">
                    Při operaci došlo k chybě. <span id="themeNameModal"></span>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-jasper" data-dismiss="modal" title="Zrušit">Zavřít</button>
                </div>
            </div>

        </div>
    </div>

    <!-- Success Modal -->
    <div id="mySuccessModal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" style="margin-left:20px">Úspěch</h4>
                </div>
                <div class="modal-body">
                    Operace byla provedena úspěšně. <span id="themeNameModal"></span>
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-jasper" data-dismiss="modal" title="Zrušit">Zavřít</button>
                </div>
            </div>

        </div>
    </div>*@
